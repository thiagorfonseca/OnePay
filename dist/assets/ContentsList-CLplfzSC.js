import{r as s,u as E,s as f,j as e,L as k}from"./index-V1BrPv90.js";const I=({type:c,title:j,subtitle:y,basePath:_})=>{const[N,o]=s.useState(!0),[m,d]=s.useState([]),[x,p]=s.useState(null),a=s.useRef(!0),{clinicId:i,clinicPackageIds:n}=E(),l=s.useCallback(async()=>{o(!0),p(null);try{if(i&&n.length){const{data:v,error:b}=await f.from("content_package_items").select("content_items (id, title, description, thumbnail_url, type, published, created_at)").in("package_id",n);if(!a.current)return;if(b)throw b;const u=new Map;(v||[]).forEach(h=>{const r=h.content_items;!r||r.published!==!0||r.type!==c||u.has(r.id)||u.set(r.id,{id:r.id,title:r.title,description:r.description,thumbnail_url:r.thumbnail_url,created_at:r.created_at})});const w=Array.from(u.values()).sort((h,r)=>(r.created_at||"").localeCompare(h.created_at||""));d(w),o(!1);return}const{data:t,error:g}=await f.from("content_items").select("id, title, description, thumbnail_url, created_at").eq("type",c).eq("published",!0).order("created_at",{ascending:!1});if(!a.current)return;if(g)throw g;d(t||[]),o(!1)}catch(t){if(!a.current)return;p(t.message||"Erro ao carregar conteúdos."),d([]),o(!1)}},[c,i,n]);return s.useEffect(()=>(a.current=!0,l(),()=>{a.current=!1}),[l]),N?e.jsx("div",{className:"h-48 flex items-center justify-center text-gray-500",children:"Carregando conteúdos..."}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:j}),e.jsx("p",{className:"text-gray-500",children:y})]}),x&&e.jsxs("div",{className:"bg-white border border-gray-100 rounded-xl p-6 text-sm text-red-600 space-y-3",children:[e.jsxs("p",{children:["Erro ao carregar conteúdos: ",x]}),e.jsx("button",{type:"button",onClick:l,className:"px-3 py-2 text-xs rounded-lg border border-red-200 text-red-600 hover:bg-red-50",children:"Tentar novamente"})]}),m.length===0?e.jsx("div",{className:"bg-white border border-gray-100 rounded-xl p-6 text-gray-500 text-sm",children:i&&n.length?"Nenhum conteúdo liberado para este pacote.":"Nenhum conteúdo publicado."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:m.map(t=>e.jsxs(k,{to:`${_}/${t.id}`,className:"group bg-white border border-gray-100 rounded-xl overflow-hidden shadow-sm hover:shadow-md transition",children:[t.thumbnail_url?e.jsx("img",{src:t.thumbnail_url,alt:t.title||"Conteúdo",className:"h-40 w-full object-cover"}):e.jsx("div",{className:"h-40 w-full bg-gradient-to-br from-slate-100 to-slate-200"}),e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsx("h3",{className:"font-semibold text-gray-800 group-hover:text-brand-600",children:t.title||"Sem título"}),t.description&&e.jsx("p",{className:"text-sm text-gray-600 line-clamp-3",children:t.description})]})]},t.id))})]})};export{I as C};
