import{u as b,r as l,j as e}from"./index-HcuLVkXM.js";import{h as v,S as N,f as _,i as w}from"./service-C61pE4fL.js";import{D as C}from"./DataTable-BxUe0ZZe.js";import{P as S}from"./plus-DDz1DOCh.js";import{X as E}from"./x-Dm__mln4.js";const L=()=>{const{effectiveClinicId:x}=b(),r=x,[d,u]=l.useState([]),[p,i]=l.useState(!0),[f,o]=l.useState(!1),[c,m]=l.useState(null),[t,s]=l.useState({nome:"",contato_nome:"",email:"",telefone:"",cnpj:"",lead_time_days:"",observacoes:""}),n=async()=>{if(r){i(!0);try{const a=await _(r);u(a)}finally{i(!1)}}};l.useEffect(()=>{n()},[r]);const y=()=>{m(null),s({nome:"",contato_nome:"",email:"",telefone:"",cnpj:"",lead_time_days:"",observacoes:""}),o(!0)},g=a=>{m(a),s({nome:a.nome||"",contato_nome:a.contato_nome||"",email:a.email||"",telefone:a.telefone||"",cnpj:a.cnpj||"",lead_time_days:a.lead_time_days?.toString()||"",observacoes:a.observacoes||""}),o(!0)},h=async()=>{if(!r)return;const a={...t,clinic_id:r,lead_time_days:t.lead_time_days?Number(t.lead_time_days):null,id:c?.id};await w(a),o(!1),await n()},j=l.useMemo(()=>[{header:"Fornecedor",accessorKey:"nome"},{header:"Contato",accessorKey:"contato_nome",cell:({row:a})=>a.original.contato_nome||"—"},{header:"Email",accessorKey:"email",cell:({row:a})=>a.original.email||"—"},{header:"Lead time",accessorKey:"lead_time_days",cell:({row:a})=>a.original.lead_time_days||"—"},{header:"Ações",cell:({row:a})=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:"rounded-md border border-gray-200 px-2 py-1 text-xs",onClick:()=>g(a.original),children:"Editar"}),e.jsx("button",{className:"rounded-md border border-red-200 px-2 py-1 text-xs text-red-600",onClick:async()=>{await v(a.original.id),await n()},children:"Remover"})]})}],[d]);return r?e.jsxs("div",{className:"space-y-6",children:[e.jsx(N,{title:"Fornecedores",subtitle:"Cadastre contatos e acompanhe histórico de compras.",actions:e.jsxs("button",{className:"inline-flex items-center gap-2 rounded-md bg-emerald-600 px-4 py-2 text-sm text-white",onClick:y,children:[e.jsx(S,{className:"h-4 w-4"})," Novo fornecedor"]})}),p?e.jsx("div",{className:"text-sm text-gray-500",children:"Carregando fornecedores..."}):e.jsx(C,{data:d,columns:j}),f?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 p-4",children:e.jsxs("div",{className:"w-full max-w-2xl rounded-2xl bg-white p-6 shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:c?"Editar fornecedor":"Novo fornecedor"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Informações comerciais e lead time."})]}),e.jsx("button",{className:"rounded-full p-2 hover:bg-gray-100",onClick:()=>o(!1),children:e.jsx(E,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"mt-6 grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Nome"}),e.jsx("input",{className:"mt-1 w-full rounded-md border border-gray-200 px-3 py-2 text-sm",value:t.nome,onChange:a=>s({...t,nome:a.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Contato"}),e.jsx("input",{className:"mt-1 w-full rounded-md border border-gray-200 px-3 py-2 text-sm",value:t.contato_nome,onChange:a=>s({...t,contato_nome:a.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Email"}),e.jsx("input",{className:"mt-1 w-full rounded-md border border-gray-200 px-3 py-2 text-sm",value:t.email,onChange:a=>s({...t,email:a.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Telefone"}),e.jsx("input",{className:"mt-1 w-full rounded-md border border-gray-200 px-3 py-2 text-sm",value:t.telefone,onChange:a=>s({...t,telefone:a.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"CNPJ"}),e.jsx("input",{className:"mt-1 w-full rounded-md border border-gray-200 px-3 py-2 text-sm",value:t.cnpj,onChange:a=>s({...t,cnpj:a.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Lead time (dias)"}),e.jsx("input",{className:"mt-1 w-full rounded-md border border-gray-200 px-3 py-2 text-sm",value:t.lead_time_days,onChange:a=>s({...t,lead_time_days:a.target.value})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Observações"}),e.jsx("textarea",{className:"mt-1 w-full rounded-md border border-gray-200 px-3 py-2 text-sm",rows:3,value:t.observacoes,onChange:a=>s({...t,observacoes:a.target.value})})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[e.jsx("button",{className:"rounded-md border border-gray-200 px-4 py-2 text-sm",onClick:()=>o(!1),children:"Cancelar"}),e.jsx("button",{className:"rounded-md bg-emerald-600 px-4 py-2 text-sm text-white",onClick:h,children:"Salvar"})]})]})}):null]}):null};export{L as default};
