import{c as dt,R as B,r as w,u as bt,a as vt,j as e,W as Nt,s as we}from"./index-Bi_Yktdj.js";import{f as v,a as Ie,b as Me}from"./utils-Bgz2xRk4.js";import{L as jt}from"./loader-2-wegoqaf-.js";import{C as Ze}from"./calendar-9FKwlTHs.js";import{i as Dt,c as Je,D as wt,f as At,E as Pt,L as Be,a as Ae,C as St,A as Et,b as xe,d as Rt,e as Le,h as kt,g as Ot,j as ut,u as Ct,G as _t,k as et,l as Tt,X as Se,Y as Ee,m as It,R as tt,n as $e,T as Fe,B as Pe,o as at}from"./generateCategoricalChart-56Zk5LGv.js";import{B as rt}from"./BarChart-6xi2Ro1t.js";const Mt=dt("ArrowDownCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]),Bt=dt("ArrowUpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);var $t=["type","layout","connectNulls","ref"],Ft=["key"];function ue(r){"@babel/helpers - typeof";return ue=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},ue(r)}function st(r,o){if(r==null)return{};var t=Lt(r,o),s,l;if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(r);for(l=0;l<h.length;l++)s=h[l],!(o.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(r,s)&&(t[s]=r[s])}return t}function Lt(r,o){if(r==null)return{};var t={};for(var s in r)if(Object.prototype.hasOwnProperty.call(r,s)){if(o.indexOf(s)>=0)continue;t[s]=r[s]}return t}function ge(){return ge=Object.assign?Object.assign.bind():function(r){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(r[s]=t[s])}return r},ge.apply(this,arguments)}function nt(r,o){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);o&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(r,l).enumerable})),t.push.apply(t,s)}return t}function F(r){for(var o=1;o<arguments.length;o++){var t=arguments[o]!=null?arguments[o]:{};o%2?nt(Object(t),!0).forEach(function(s){K(r,s,t[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):nt(Object(t)).forEach(function(s){Object.defineProperty(r,s,Object.getOwnPropertyDescriptor(t,s))})}return r}function de(r){return Ht(r)||zt(r)||Vt(r)||Ut()}function Ut(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vt(r,o){if(r){if(typeof r=="string")return Ue(r,o);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ue(r,o)}}function zt(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Ht(r){if(Array.isArray(r))return Ue(r)}function Ue(r,o){(o==null||o>r.length)&&(o=r.length);for(var t=0,s=new Array(o);t<o;t++)s[t]=r[t];return s}function Kt(r,o){if(!(r instanceof o))throw new TypeError("Cannot call a class as a function")}function ot(r,o){for(var t=0;t<o.length;t++){var s=o[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(r,pt(s.key),s)}}function Wt(r,o,t){return o&&ot(r.prototype,o),t&&ot(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function qt(r,o,t){return o=Re(o),Yt(r,mt()?Reflect.construct(o,t||[],Re(r).constructor):o.apply(r,t))}function Yt(r,o){if(o&&(ue(o)==="object"||typeof o=="function"))return o;if(o!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Xt(r)}function Xt(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function mt(){try{var r=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mt=function(){return!!r})()}function Re(r){return Re=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Re(r)}function Qt(r,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(o&&o.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),o&&Ve(r,o)}function Ve(r,o){return Ve=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,l){return s.__proto__=l,s},Ve(r,o)}function K(r,o,t){return o=pt(o),o in r?Object.defineProperty(r,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[o]=t,r}function pt(r){var o=Gt(r,"string");return ue(o)=="symbol"?o:o+""}function Gt(r,o){if(ue(r)!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var s=t.call(r,o);if(ue(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(r)}var ye=(function(r){function o(){var t;Kt(this,o);for(var s=arguments.length,l=new Array(s),h=0;h<s;h++)l[h]=arguments[h];return t=qt(this,o,[].concat(l)),K(t,"state",{isAnimationFinished:!0,totalLength:0}),K(t,"generateSimpleStrokeDasharray",function(d,u){return"".concat(u,"px ").concat(d-u,"px")}),K(t,"getStrokeDasharray",function(d,u,g){var j=g.reduce(function(S,M){return S+M});if(!j)return t.generateSimpleStrokeDasharray(u,d);for(var P=Math.floor(d/j),E=d%j,R=u-d,k=[],A=0,D=0;A<g.length;D+=g[A],++A)if(D+g[A]>E){k=[].concat(de(g.slice(0,A)),[E-D]);break}var C=k.length%2===0?[0,R]:[R];return[].concat(de(o.repeat(g,P)),de(k),C).map(function(S){return"".concat(S,"px")}).join(", ")}),K(t,"id",Ct("recharts-line-")),K(t,"pathRef",function(d){t.mainCurve=d}),K(t,"handleAnimationEnd",function(){t.setState({isAnimationFinished:!0}),t.props.onAnimationEnd&&t.props.onAnimationEnd()}),K(t,"handleAnimationStart",function(){t.setState({isAnimationFinished:!1}),t.props.onAnimationStart&&t.props.onAnimationStart()}),t}return Qt(o,r),Wt(o,[{key:"componentDidMount",value:function(){if(this.props.isAnimationActive){var s=this.getTotalLength();this.setState({totalLength:s})}}},{key:"componentDidUpdate",value:function(){if(this.props.isAnimationActive){var s=this.getTotalLength();s!==this.state.totalLength&&this.setState({totalLength:s})}}},{key:"getTotalLength",value:function(){var s=this.mainCurve;try{return s&&s.getTotalLength&&s.getTotalLength()||0}catch{return 0}}},{key:"renderErrorBar",value:function(s,l){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var h=this.props,d=h.points,u=h.xAxis,g=h.yAxis,j=h.layout,P=h.children,E=At(P,Pt);if(!E)return null;var R=function(D,C){return{x:D.x,y:D.y,value:D.value,errorVal:ut(D.payload,C)}},k={clipPath:s?"url(#clipPath-".concat(l,")"):null};return B.createElement(Be,k,E.map(function(A){return B.cloneElement(A,{key:"bar-".concat(A.props.dataKey),data:d,xAxis:u,yAxis:g,layout:j,dataPointFormatter:R})}))}},{key:"renderDots",value:function(s,l,h){var d=this.props.isAnimationActive;if(d&&!this.state.isAnimationFinished)return null;var u=this.props,g=u.dot,j=u.points,P=u.dataKey,E=Ae(this.props,!1),R=Ae(g,!0),k=j.map(function(D,C){var S=F(F(F({key:"dot-".concat(C),r:3},E),R),{},{index:C,cx:D.x,cy:D.y,value:D.value,dataKey:P,payload:D.payload,points:j});return o.renderDotItem(g,S)}),A={clipPath:s?"url(#clipPath-".concat(l?"":"dots-").concat(h,")"):null};return B.createElement(Be,ge({className:"recharts-line-dots",key:"dots"},A),k)}},{key:"renderCurveStatically",value:function(s,l,h,d){var u=this.props,g=u.type,j=u.layout,P=u.connectNulls;u.ref;var E=st(u,$t),R=F(F(F({},Ae(E,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:l?"url(#clipPath-".concat(h,")"):null,points:s},d),{},{type:g,layout:j,connectNulls:P});return B.createElement(St,ge({},R,{pathRef:this.pathRef}))}},{key:"renderCurveWithAnimation",value:function(s,l){var h=this,d=this.props,u=d.points,g=d.strokeDasharray,j=d.isAnimationActive,P=d.animationBegin,E=d.animationDuration,R=d.animationEasing,k=d.animationId,A=d.animateNewValues,D=d.width,C=d.height,S=this.state,M=S.prevPoints,L=S.totalLength;return B.createElement(Et,{begin:P,duration:E,isActive:j,easing:R,from:{t:0},to:{t:1},key:"line-".concat(k),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(q){var $=q.t;if(M){var re=M.length/u.length,U=u.map(function(O,le){var G=Math.floor(le*re);if(M[G]){var Z=M[G],J=xe(Z.x,O.x),ke=xe(Z.y,O.y);return F(F({},O),{},{x:J($),y:ke($)})}if(A){var Oe=xe(D*2,O.x),Ce=xe(C/2,O.y);return F(F({},O),{},{x:Oe($),y:Ce($)})}return F(F({},O),{},{x:O.x,y:O.y})});return h.renderCurveStatically(U,s,l)}var ie=xe(0,L),Y=ie($),X;if(g){var Q="".concat(g).split(/[,\s]+/gim).map(function(O){return parseFloat(O)});X=h.getStrokeDasharray(Y,L,Q)}else X=h.generateSimpleStrokeDasharray(L,Y);return h.renderCurveStatically(u,s,l,{strokeDasharray:X})})}},{key:"renderCurve",value:function(s,l){var h=this.props,d=h.points,u=h.isAnimationActive,g=this.state,j=g.prevPoints,P=g.totalLength;return u&&d&&d.length&&(!j&&P>0||!Rt(j,d))?this.renderCurveWithAnimation(s,l):this.renderCurveStatically(d,s,l)}},{key:"render",value:function(){var s,l=this.props,h=l.hide,d=l.dot,u=l.points,g=l.className,j=l.xAxis,P=l.yAxis,E=l.top,R=l.left,k=l.width,A=l.height,D=l.isAnimationActive,C=l.id;if(h||!u||!u.length)return null;var S=this.state.isAnimationFinished,M=u.length===1,L=Je("recharts-line",g),q=j&&j.allowDataOverflow,$=P&&P.allowDataOverflow,re=q||$,U=Le(C)?this.id:C,ie=(s=Ae(d,!1))!==null&&s!==void 0?s:{r:3,strokeWidth:2},Y=ie.r,X=Y===void 0?3:Y,Q=ie.strokeWidth,O=Q===void 0?2:Q,le=kt(d)?d:{},G=le.clipDot,Z=G===void 0?!0:G,J=X*2+O;return B.createElement(Be,{className:L},q||$?B.createElement("defs",null,B.createElement("clipPath",{id:"clipPath-".concat(U)},B.createElement("rect",{x:q?R:R-k/2,y:$?E:E-A/2,width:q?k:k*2,height:$?A:A*2})),!Z&&B.createElement("clipPath",{id:"clipPath-dots-".concat(U)},B.createElement("rect",{x:R-J/2,y:E-J/2,width:k+J,height:A+J}))):null,!M&&this.renderCurve(re,U),this.renderErrorBar(re,U),(M||d)&&this.renderDots(re,Z,U),(!D||S)&&Ot.renderCallByParent(this.props,u))}}],[{key:"getDerivedStateFromProps",value:function(s,l){return s.animationId!==l.prevAnimationId?{prevAnimationId:s.animationId,curPoints:s.points,prevPoints:l.curPoints}:s.points!==l.curPoints?{curPoints:s.points}:null}},{key:"repeat",value:function(s,l){for(var h=s.length%2!==0?[].concat(de(s),[0]):s,d=[],u=0;u<l;++u)d=[].concat(de(d),de(h));return d}},{key:"renderDotItem",value:function(s,l){var h;if(B.isValidElement(s))h=B.cloneElement(s,l);else if(Dt(s))h=s(l);else{var d=l.key,u=st(l,Ft),g=Je("recharts-line-dot",typeof s!="boolean"?s.className:"");h=B.createElement(wt,ge({key:d},u,{className:g}))}return h}}])})(w.PureComponent);K(ye,"displayName","Line");K(ye,"defaultProps",{xAxisId:0,yAxisId:0,connectNulls:!1,activeDot:!0,dot:!0,legendType:"line",stroke:"#3182bd",strokeWidth:1,fill:"#fff",points:[],isAnimationActive:!_t.isSsr,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",hide:!1,label:!1});K(ye,"getComposedData",function(r){var o=r.props,t=r.xAxis,s=r.yAxis,l=r.xAxisTicks,h=r.yAxisTicks,d=r.dataKey,u=r.bandSize,g=r.displayedData,j=r.offset,P=o.layout,E=g.map(function(R,k){var A=ut(R,d);return P==="horizontal"?{x:et({axis:t,ticks:l,bandSize:u,entry:R,index:k}),y:Le(A)?null:s.scale(A),value:A,payload:R}:{x:Le(A)?null:t.scale(A),y:et({axis:s,ticks:h,bandSize:u,entry:R,index:k}),value:A,payload:R}});return F({points:E,layout:P},j)});var Zt=Tt({chartName:"LineChart",GraphicalChild:ye,axisComponents:[{axisType:"xAxis",AxisComp:Se},{axisType:"yAxis",AxisComp:Ee}],formatAxisMap:It});const Jt={DINHEIRO:{diasAtePrimeiroRecebimento:0,intervaloDias:0},PIX:{diasAtePrimeiroRecebimento:0,intervaloDias:0},DEBITO:{diasAtePrimeiroRecebimento:1,intervaloDias:0,usarDiasUteis:!0},CREDITO:{diasAtePrimeiroRecebimento:30,intervaloDias:30},BOLETO:{usarDataVencimento:!0},CHEQUE:{usarDataVencimento:!0},TRANSFERENCIA:{diasAtePrimeiroRecebimento:0,intervaloDias:0},CONVENIO:{diasAtePrimeiroRecebimento:30,intervaloDias:30},OUTRO:{diasAtePrimeiroRecebimento:0,intervaloDias:0}},it=(r,o)=>{const t=new Date(r);return t.setDate(t.getDate()+o),t},ea=(r,o)=>{const t=new Date(r);let s=0;for(;s<o;){t.setDate(t.getDate()+1);const l=t.getDay();l!==0&&l!==6&&(s+=1)}return t},lt=(r,o)=>{const t=new Date(r);return t.setMonth(t.getMonth()+o),t},ta=(r,o)=>{const t=Math.floor(r/o*100)/100,s=Array(o).fill(t),l=t*o,h=Math.round((r-l)*100)/100;return s[s.length-1]=Math.round((s[s.length-1]+h)*100)/100,s};function aa(r){const o=[];return r.forEach(t=>{const s=(t.datasParcelas||[]).filter(Boolean),l=Math.max(1,s.length||t.numeroParcelas||1),h=ta(t.valorTotal,l),d=[];if(s.length)d.push(...s.slice(0,l));else if(t.tipo==="RECEITA"){const u=Jt[t.formaPagamento],g=t.dataVencimento||t.dataEmissao,j=u.usarDataVencimento?g:u.diasAtePrimeiroRecebimento&&!t.dataVencimento?u.usarDiasUteis?ea(g,u.diasAtePrimeiroRecebimento):it(g,u.diasAtePrimeiroRecebimento):g;for(let P=0;P<l;P++)u.intervaloDias&&P>0?d.push(it(j,u.intervaloDias*P)):!u.intervaloDias&&P>0?d.push(lt(j,P)):d.push(j)}else{const u=t.dataVencimento||t.dataEmissao;for(let g=0;g<l;g++)d.push(lt(u,g))}h.forEach((u,g)=>{const j=t.status==="REALIZADO"&&!!t.dataBaixa;o.push({lancamentoId:t.id,tipo:t.tipo,dataPrevista:d[g]||t.dataEmissao,valor:u,status:j?"REALIZADO":"PREVISTO",dataRealizado:j?t.dataBaixa:void 0})})}),o}function ra(r){const o=new Map;return r.forEach(t=>{const s=t.dataPrevista.toISOString().split("T")[0],l=o.get(s)||{data:new Date(s),totalReceitasPrevistas:0,totalDespesasPrevistas:0,saldoPrevistoDia:0};t.tipo==="RECEITA"?l.totalReceitasPrevistas+=t.valor:l.totalDespesasPrevistas+=t.valor,l.saldoPrevistoDia=l.totalReceitasPrevistas-l.totalDespesasPrevistas,o.set(s,l)}),Array.from(o.values()).sort((t,s)=>t.data.getTime()-s.data.getTime())}function sa(r){const o=new Map;return r.forEach(t=>{const s=t.dataPrevista.getFullYear(),l=t.dataPrevista.getMonth()+1,h=`${s}-${l}`,d=o.get(h)||{ano:s,mes:l,totalReceitasPrevistas:0,totalDespesasPrevistas:0,saldoPrevistoMes:0};t.tipo==="RECEITA"?d.totalReceitasPrevistas+=t.valor:d.totalDespesasPrevistas+=t.valor,d.saldoPrevistoMes=d.totalReceitasPrevistas-d.totalDespesasPrevistas,o.set(h,d)}),Array.from(o.values()).sort((t,s)=>t.ano-s.ano||t.mes-s.mes)}function ct(r,o){let t=o;return r.map(s=>(t+=s.saldoPrevistoDia,{...s,saldoAcumulado:t}))}const ua=()=>{const{effectiveClinicId:r,isAdmin:o,selectedClinicId:t}=bt(),[s,l]=vt(),[h,d]=w.useState(!0),[u,g]=w.useState([]),[j,P]=w.useState([]),[E,R]=w.useState([]),[k,A]=w.useState([]),[D,C]=w.useState(()=>new Date(new Date().getFullYear(),new Date().getMonth(),1)),[S,M]=w.useState(()=>new Date(new Date().getFullYear(),new Date().getMonth()+1,0)),L=a=>!a||Number.isNaN(a.getTime())?"":a.toISOString().split("T")[0],q=a=>{if(!a)return null;const n=new Date(`${a}T00:00:00`);return Number.isNaN(n.getTime())?null:n},$=a=>{if(typeof a=="string"){const i=Number(a.replace(",","."));return isNaN(i)?0:i}const n=Number(a||0);return isNaN(n)?0:n},re=async(a,n,i)=>{if(!a.length)return a;const m=c=>{if(!c)return null;const p=new Date(c);if(!Number.isNaN(p.getTime()))return p;const b=new Date(`${c}T00:00:00`);return Number.isNaN(b.getTime())?null:b},y=(c,p)=>{const b=new Date(c);return b.setDate(b.getDate()+p),b},x=(c,p)=>{const b=new Date(c);let T=0;for(;T<p;){b.setDate(b.getDate()+1);const I=b.getDay();I!==0&&I!==6&&(T+=1)}return b},_=(c,p)=>{const b=new Date(c);return b.setMonth(b.getMonth()+p),b},pe=c=>{const p=(c||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toUpperCase();return p.includes("CREDITO")?"CREDITO":p.includes("DEBITO")?"DEBITO":p.includes("PIX")?"PIX":p.includes("BOLETO")?"BOLETO":p.includes("CHEQUE")?"CHEQUE":p.includes("TRANSFER")||p.includes("TED")||p.includes("DOC")?"TRANSFERENCIA":p.includes("CONVENIO")?"CONVENIO":p.includes("DINHEIRO")||p.includes("CASH")?"DINHEIRO":"OUTRO"},he=(c,p)=>{const b=Math.floor(c/p*100)/100,T=Array(p).fill(b),I=b*p,te=Math.round((c-I)*100)/100;return T[T.length-1]=Math.round((T[T.length-1]+te)*100)/100,T},z=c=>{if(!c)return[];try{const p=Array.isArray(c)?c:typeof c=="string"?JSON.parse(c):[];return Array.isArray(p)?p.map(b=>typeof b=="string"?{vencimento:b}:!b||typeof b!="object"?null:{vencimento:b.vencimento||b.due_date||b.data||b.date||""}).filter(Boolean):[]}catch{return[]}},oe=new Date;oe.setHours(0,0,0,0);const fe=c=>{const p=Number(c.valor_liquido??c.valor_bruto??c.valor??0);if(!Number.isFinite(p)||p===0)return 0;const b=z(c.recebimento_parcelas).map(H=>m(H.vencimento)).filter(Boolean),T=Math.max(1,b.length||parseInt(c.parcelas||"1",10)||1),I=pe(c.forma_pagamento),te=m(c.data_recebimento),ce=m(c.data_competencia);let ae=null;if(I==="BOLETO"||I==="CHEQUE"?ae=te||ce:I==="CREDITO"||I==="CONVENIO"?ae=te||(ce?y(ce,30):null):I==="DEBITO"?ae=te||(ce?x(ce,1):null):ae=te||ce,!ae&&b.length===0)return 0;const Te=I==="CREDITO"||I==="CONVENIO"?30:0,yt=he(p,T);let Ge=0;for(let H=0;H<T;H+=1){let De=b[H]||ae;De&&(b[H]||(Te&&H>0?De=y(ae,Te*H):!Te&&T>1&&H>0&&(De=_(ae,H))),De<=oe&&(Ge+=yt[H]||0))}return Ge},V=new Map;n.forEach(c=>{if(!c.bank_account_id)return;const p=fe(c);!Number.isFinite(p)||p===0||V.set(c.bank_account_id,(V.get(c.bank_account_id)||0)+p)});const W=new Map;i.forEach(c=>{if(!c.bank_account_id||c.status!=="paid")return;const p=Number(c.valor??0);Number.isFinite(p)&&W.set(c.bank_account_id,(W.get(c.bank_account_id)||0)+p)});const f=[],N=a.map(c=>{const p=$(c.initial_balance??0),b=V.get(c.id)||0,T=W.get(c.id)||0,I=p+b-T,te=$(c.current_balance??c.initial_balance??0);return Math.abs(te-I)>.009&&f.push({id:c.id,current_balance:I}),{...c,current_balance:I}});return f.length&&await Promise.all(f.map(c=>we.from("bank_accounts").update({current_balance:c.current_balance}).eq("id",c.id))),N},[U,ie]=w.useState(()=>s.get("tab")==="caixa"?"caixa":"dre"),[Y,X]=w.useState("linha"),Q=w.useRef(null);w.useEffect(()=>{if(!r&&!o)return;(async()=>{d(!0);try{const n=r;let i=we.from("revenues").select("id, description, valor_liquido, valor_bruto, data_competencia, data_recebimento, forma_pagamento, parcelas, status, recebimento_parcelas, categories(name), bank_account_id");n&&(i=i.eq("clinic_id",n));const{data:m}=await i;let y=we.from("expenses").select("id, description, valor, data_competencia, data_pagamento, data_vencimento, forma_pagamento, parcelas, status, categories(name), bank_account_id");n&&(y=y.eq("clinic_id",n));const{data:x}=await y;let _=we.from("bank_accounts").select("id, clinic_id, current_balance, initial_balance");n&&(_=_.eq("clinic_id",n));const{data:pe}=await _,he=await re(pe||[],m||[],x||[]);g(he||[]),R(m||[]),A(x||[]);const z=f=>{if(!f)return;const N=new Date(f);return Number.isNaN(N.getTime())?void 0:N},oe=f=>{const N=(f||"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toUpperCase();return N.includes("CREDITO")?"CREDITO":N.includes("DEBITO")?"DEBITO":N.includes("PIX")?"PIX":N.includes("BOLETO")?"BOLETO":N.includes("CHEQUE")?"CHEQUE":N.includes("TRANSFER")||N.includes("TED")||N.includes("DOC")?"TRANSFERENCIA":N.includes("CONVENIO")?"CONVENIO":N.includes("DINHEIRO")||N.includes("CASH")?"DINHEIRO":"OUTRO"},fe=f=>{if(!f)return[];try{const N=Array.isArray(f)?f:typeof f=="string"?JSON.parse(f):[];return Array.isArray(N)?N.map(c=>typeof c=="string"?z(c):!c||typeof c!="object"?null:z(c.vencimento||c.due_date||c.data||c.date||"")).filter(Boolean):[]}catch{return[]}},V=[];(m||[]).forEach(f=>{const N=z(f.data_competencia);if(!N)return;const c=fe(f.recebimento_parcelas);V.push({id:f.id,tipo:"RECEITA",descricao:f.description||"Receita",dataEmissao:N,dataVencimento:z(f.data_recebimento),formaPagamento:oe(f.forma_pagamento),valorTotal:f.valor_liquido||f.valor_bruto||0,numeroParcelas:Math.max(1,c.length||parseInt(f.parcelas||1,10)),datasParcelas:c.length?c:void 0,status:f.status==="paid"?"REALIZADO":"PREVISTO",dataBaixa:z(f.data_recebimento)})}),(x||[]).forEach(f=>{const N=z(f.data_competencia);N&&V.push({id:f.id,tipo:"DESPESA",descricao:f.description||"Despesa",dataEmissao:N,dataVencimento:z(f.data_vencimento||f.data_competencia),formaPagamento:oe(f.forma_pagamento),valorTotal:f.valor||0,numeroParcelas:parseInt(f.parcelas||1,10),status:f.status==="paid"?"REALIZADO":"PREVISTO",dataBaixa:z(f.data_pagamento)})});const W=aa(V);P(W)}catch(n){console.error("Erro ao carregar dashboard:",n)}finally{d(!1)}})()},[r,o,t]);const O=a=>{if(!a)return!1;const n=a instanceof Date?a:new Date(a);return n>=D&&n<=S},le=a=>a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"),G=(a,n)=>{const i=n.map(m=>`<Row>${m.map(x=>{const _=x.type==="Number"?x.value:le(String(x.value));return`<Cell><Data ss:Type="${x.type}">${_}</Data></Cell>`}).join("")}</Row>`).join("");return`<?xml version="1.0"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"><Worksheet ss:Name="${le(a)}"><Table>${i}</Table></Worksheet></Workbook>`},Z=a=>new Promise(n=>{if(!a){n(null);return}const i=a.querySelector("svg");if(!i){n(null);return}const m=i.getBoundingClientRect(),y=Math.max(1,Math.floor(m.width))||Number(i.getAttribute("width"))||800,x=Math.max(1,Math.floor(m.height))||Number(i.getAttribute("height"))||400,_=i.cloneNode(!0);_.setAttribute("xmlns","http://www.w3.org/2000/svg"),_.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),_.setAttribute("width",String(y)),_.setAttribute("height",String(x)),_.getAttribute("viewBox")||_.setAttribute("viewBox",`0 0 ${y} ${x}`);const pe=i.querySelectorAll("*"),he=_.querySelectorAll("*");pe.forEach((f,N)=>{const c=he[N];if(!c||!(f instanceof Element))return;const p=window.getComputedStyle(f),b=[`fill:${p.getPropertyValue("fill")};`,`stroke:${p.getPropertyValue("stroke")};`,`stroke-width:${p.getPropertyValue("stroke-width")};`,`font-size:${p.getPropertyValue("font-size")};`,`font-family:${p.getPropertyValue("font-family")};`,`font-weight:${p.getPropertyValue("font-weight")};`,`opacity:${p.getPropertyValue("opacity")};`],T=c.getAttribute("style")||"";c.setAttribute("style",`${T}${b.join("")}`)});const oe=new XMLSerializer().serializeToString(_),fe=new Blob([oe],{type:"image/svg+xml;charset=utf-8"}),V=URL.createObjectURL(fe),W=new Image;W.onload=()=>{const f=document.createElement("canvas");f.width=y,f.height=x;const N=f.getContext("2d");if(!N){URL.revokeObjectURL(V),n(null);return}N.fillStyle="#ffffff",N.fillRect(0,0,y,x),N.drawImage(W,0,0,y,x),URL.revokeObjectURL(V),n(f.toDataURL("image/png"))},W.onerror=()=>{URL.revokeObjectURL(V),n(null)},W.src=V}),J=async(a,n)=>{const i=await Z(a);if(!i)return;const m=document.createElement("a");m.href=i,m.download=`${n}.png`,m.click()},ke=async(a,n)=>{const i=await Z(a);if(!i)return;const m=window.open("","_blank");m&&(m.document.write(`
      <html>
        <head>
          <title>${n}</title>
          <style>body{font-family:Arial;padding:16px;text-align:center;}img{max-width:100%;}</style>
        </head>
        <body>
          <h3>${n}</h3>
          <img id="chart-image" src="${i}" alt="${n}" />
          <script>
            const img = document.getElementById('chart-image');
            img.onload = () => { window.print(); };
          <\/script>
        </body>
      </html>
    `),m.document.close())},Oe=()=>{const a=[[{type:"String",value:"Data"},{type:"String",value:"Receitas"},{type:"String",value:"Despesas"},{type:"String",value:"Saldo do Dia"},{type:"String",value:"Saldo Acumulado"},{type:"String",value:"Saldo Banco"}],...ve.map(x=>[{type:"String",value:x.data.toLocaleDateString("pt-BR")},{type:"Number",value:Number(x.totalReceitasPrevistas||0)},{type:"Number",value:Number(x.totalDespesasPrevistas||0)},{type:"Number",value:Number(x.saldoPrevistoDia||0)},{type:"Number",value:Number(x.saldoAcumulado||0)},{type:"Number",value:Number(x.saldoBanco||0)}])],n=G("Fluxo Previsto (período)",a),i=new Blob([n],{type:"application/xml;charset=utf-8;"}),m=URL.createObjectURL(i),y=document.createElement("a");y.href=m,y.download=`fluxo-previsto-periodo-${L(D)}-${L(S)}.xml`,y.click(),URL.revokeObjectURL(m)},Ce=()=>{const a=ve.map(i=>`
      <tr>
        <td>${i.data.toLocaleDateString("pt-BR")}</td>
        <td>${v(i.totalReceitasPrevistas)}</td>
        <td>${v(i.totalDespesasPrevistas)}</td>
        <td>${v(i.saldoPrevistoDia)}</td>
        <td>${v(i.saldoAcumulado)}</td>
        <td>${v(i.saldoBanco||0)}</td>
      </tr>
    `).join(""),n=window.open("","_blank");n&&(n.document.write(`
      <html><head><title>Fluxo Previsto (período)</title>
      <style>table{border-collapse:collapse;width:100%;font-family:Arial;}th,td{border:1px solid #ddd;padding:6px;font-size:12px;}th{background:#f3f4f6;text-align:left;}</style>
      </head><body>
      <h3>Fluxo Previsto (período)</h3>
      <table><thead><tr><th>Data</th><th>Receitas</th><th>Despesas</th><th>Saldo do Dia</th><th>Saldo Acumulado</th><th>Saldo Banco</th></tr></thead>
      <tbody>${a}</tbody>
      </table>
      </body></html>
    `),n.document.close(),n.print())},ht=()=>{const a=[[{type:"String",value:"Competência"},{type:"String",value:"Receitas"},{type:"String",value:"Despesas"},{type:"String",value:"Saldo"},{type:"String",value:"Saldo Acumulado"},{type:"String",value:"Saldo Banco"}],...Ne.map(x=>[{type:"String",value:`${String(x.mes).padStart(2,"0")}/${x.ano}`},{type:"Number",value:Number(x.totalReceitasPrevistas||0)},{type:"Number",value:Number(x.totalDespesasPrevistas||0)},{type:"Number",value:Number(x.saldoPrevistoMes||0)},{type:"Number",value:Number(x.saldoAcumulado||0)},{type:"Number",value:Number(x.saldoBanco||0)}])],n=G("Fluxo Previsto (mensal)",a),i=new Blob([n],{type:"application/xml;charset=utf-8;"}),m=URL.createObjectURL(i),y=document.createElement("a");y.href=m,y.download=`fluxo-previsto-mensal-${L(D)}-${L(S)}.xml`,y.click(),URL.revokeObjectURL(m)},ft=()=>{const a=Ne.map(i=>`
      <tr>
        <td>${String(i.mes).padStart(2,"0")}/${i.ano}</td>
        <td>${v(i.totalReceitasPrevistas)}</td>
        <td>${v(i.totalDespesasPrevistas)}</td>
        <td>${v(i.saldoPrevistoMes)}</td>
        <td>${v(i.saldoAcumulado)}</td>
        <td>${v(i.saldoBanco||0)}</td>
      </tr>
    `).join(""),n=window.open("","_blank");n&&(n.document.write(`
      <html><head><title>Fluxo Previsto (mensal)</title>
      <style>table{border-collapse:collapse;width:100%;font-family:Arial;}th,td{border:1px solid #ddd;padding:6px;font-size:12px;}th{background:#f3f4f6;text-align:left;}</style>
      </head><body>
      <h3>Fluxo Previsto (mensal)</h3>
      <table><thead><tr><th>Competência</th><th>Receitas</th><th>Despesas</th><th>Saldo</th><th>Saldo Acumulado</th><th>Saldo Banco</th></tr></thead>
      <tbody>${a}</tbody>
      </table>
      </body></html>
    `),n.document.close(),n.print())},se=w.useMemo(()=>u.reduce((a,n)=>{const i=n.current_balance??n.initial_balance??0,m=typeof i=="string"?Number(i.replace(",",".")):i;return a+(isNaN(m)?0:m)},0),[u]),be=w.useMemo(()=>E.filter(a=>O(a.data_competencia)).reduce((a,n)=>a+(n.valor_liquido||n.valor_bruto||0),0),[E,D,S]),_e=w.useMemo(()=>k.filter(a=>O(a.data_competencia)).reduce((a,n)=>a+(n.valor||0),0),[k,D,S]),ze=w.useMemo(()=>{const a=new Map;return E.forEach(n=>{const i=n.data_competencia;if(!i||!O(i))return;const m=new Date(i),y=`${m.getFullYear()}-${String(m.getMonth()+1).padStart(2,"0")}`,x=a.get(y)||{date:y,receitas:0,despesas:0,resultado:0};x.receitas+=Number(n.valor_liquido||n.valor_bruto||n.valor||0),a.set(y,x)}),k.forEach(n=>{const i=n.data_competencia;if(!i||!O(i))return;const m=new Date(i),y=`${m.getFullYear()}-${String(m.getMonth()+1).padStart(2,"0")}`,x=a.get(y)||{date:y,receitas:0,despesas:0,resultado:0};x.despesas+=Number(n.valor||0),a.set(y,x)}),Array.from(a.values()).map(n=>({...n,resultado:n.receitas-n.despesas})).sort((n,i)=>n.date.localeCompare(i.date))},[E,k,D,S]),ee=w.useMemo(()=>j.filter(a=>O(a.dataPrevista)),[j,D,S]),ne=w.useMemo(()=>{const a=ra(ee),n=new Map;a.forEach(m=>{const y=m.data.toISOString().split("T")[0];n.set(y,m)});const i=new Date;if(i.setHours(0,0,0,0),i>=D&&i<=S){const m=i.toISOString().split("T")[0];n.has(m)||n.set(m,{data:i,totalReceitasPrevistas:0,totalDespesasPrevistas:0,saldoPrevistoDia:0})}return Array.from(n.values()).sort((m,y)=>m.data.getTime()-y.data.getTime())},[ee,D,S]),He=w.useMemo(()=>ct(ne,0),[ne]),Ke=w.useMemo(()=>{if(!ne.length)return se;const a=new Date;if(a.setHours(0,0,0,0),a<D||a>S)return se;const n=ne.reduce((i,m)=>m.data<=a?i+m.saldoPrevistoDia:i,0);return se-n},[ne,se,D,S]),me=w.useMemo(()=>ct(ne,Ke),[ne,Ke]),We=w.useMemo(()=>me.map(a=>{const n=Number(a.totalReceitasPrevistas??0),i=Number(a.totalDespesasPrevistas??0),m=Number(a.saldoPrevistoDia??n-i),y=Number(a.saldoAcumulado??0),x=y-m;return{data:a.data.toISOString().split("T")[0],saldo:y,entrada:n,saida:i,saldoBanco:x}}),[me]),ve=w.useMemo(()=>He.map((a,n)=>({...a,saldoBanco:me[n]?.saldoAcumulado??a.saldoAcumulado})),[He,me]),xt=w.useMemo(()=>ee.filter(a=>a.tipo==="RECEITA").reduce((a,n)=>a+n.valor,0),[ee]),gt=w.useMemo(()=>ee.filter(a=>a.tipo==="DESPESA").reduce((a,n)=>a+n.valor,0),[ee]),qe=w.useMemo(()=>sa(ee),[ee]),Ye=w.useMemo(()=>{let a=0;return qe.map(n=>(a+=n.saldoPrevistoMes,{...n,saldoAcumulado:a}))},[qe]),Ne=w.useMemo(()=>Ye.map(a=>({...a,saldoBanco:se+a.saldoAcumulado})),[Ye,se]),je=a=>{const n=new Date;if(a==="today")C(new Date(n.getFullYear(),n.getMonth(),n.getDate())),M(new Date(n.getFullYear(),n.getMonth(),n.getDate()));else if(a==="week"){const i=new Date(n),m=new Date(n);m.setDate(m.getDate()+6),C(i),M(m)}else a==="month"?(C(new Date(n.getFullYear(),n.getMonth(),1)),M(new Date(n.getFullYear(),n.getMonth()+1,0))):(C(new Date(n.getFullYear(),0,1)),M(new Date(n.getFullYear(),11,31)))},Xe=a=>{ie(a),s.set("tab",a),l(s)},Qe=({active:a,payload:n})=>{if(!a||!n?.length)return null;const i=n[0]?.payload;return i?e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white px-3 py-2 text-xs text-gray-700 shadow-md",children:[e.jsxs("div",{className:"font-semibold text-gray-900",children:["Data: ",Me(i.data)]}),e.jsxs("div",{className:"mt-1 space-y-1",children:[e.jsxs("div",{children:["Saldo Banco: ",v(i.saldoBanco??0)]}),e.jsxs("div",{children:["Entrada: ",v(i.entrada??0)]}),e.jsxs("div",{children:["Saída: ",v(i.saida??0)]}),e.jsxs("div",{className:"font-semibold",children:["Saldo: ",v(i.saldo??0)]})]})]}):null};return h?e.jsxs("div",{className:"flex flex-col items-center justify-center h-96 text-gray-400",children:[e.jsx(jt,{size:48,className:"animate-spin mb-4 text-brand-500"}),e.jsx("p",{children:"Carregando indicadores financeiros..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Visão Geral"}),e.jsx("p",{className:"text-gray-500",children:"Resumo financeiro em tempo real"})]}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:()=>Xe("dre"),className:`px-4 py-2 text-sm rounded-lg border ${U==="dre"?"bg-brand-600 text-white border-brand-600":"bg-white text-gray-700 border-gray-200"}`,children:"DRE"}),e.jsx("button",{onClick:()=>Xe("caixa"),className:`px-4 py-2 text-sm rounded-lg border ${U==="caixa"?"bg-brand-600 text-white border-brand-600":"bg-white text-gray-700 border-gray-200"}`,children:"Fluxo de Caixa"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex flex-col md:flex-row md:items-center gap-3",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx("button",{onClick:()=>je("today"),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg hover:bg-gray-50",children:"Dia"}),e.jsx("button",{onClick:()=>je("week"),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg hover:bg-gray-50",children:"Semana"}),e.jsx("button",{onClick:()=>je("month"),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg hover:bg-gray-50",children:"Mês"}),e.jsx("button",{onClick:()=>je("year"),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg hover:bg-gray-50",children:"Ano"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ze,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"date",value:L(D),onChange:a=>{const n=q(a.target.value);n&&C(n)},className:"pl-9 pr-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-brand-500 focus:border-brand-500"})]}),e.jsx("span",{className:"text-gray-400",children:"até"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ze,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"date",value:L(S),onChange:a=>{const n=q(a.target.value);n&&M(n)},className:"pl-9 pr-3 py-2 border border-gray-200 rounded-lg text-sm focus:ring-brand-500 focus:border-brand-500"})]})]})]}),U==="dre"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 mb-1",children:"Saldo em Contas"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:v(se)})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-50 rounded-full flex items-center justify-center text-blue-600",children:e.jsx(Nt,{size:24})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 mb-1",children:"Total Receitas (competência)"}),e.jsx("h3",{className:"text-2xl font-bold text-green-600",children:v(be)})]}),e.jsx("div",{className:"w-12 h-12 bg-green-50 rounded-full flex items-center justify-center text-green-600",children:e.jsx(Bt,{size:24})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 mb-1",children:"Total Despesas (competência)"}),e.jsx("h3",{className:"text-2xl font-bold text-red-600",children:v(_e)})]}),e.jsx("div",{className:"w-12 h-12 bg-red-50 rounded-full flex items-center justify-center text-red-600",children:e.jsx(Mt,{size:24})})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"DRE (competência)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-lg border border-gray-100 bg-green-50",children:[e.jsx("p",{className:"text-xs uppercase text-gray-600",children:"Receitas"}),e.jsx("p",{className:"text-xl font-bold text-green-700",children:v(be)})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-gray-100 bg-red-50",children:[e.jsx("p",{className:"text-xs uppercase text-gray-600",children:"Despesas"}),e.jsx("p",{className:"text-xl font-bold text-red-700",children:v(_e)})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-gray-100 bg-blue-50",children:[e.jsx("p",{className:"text-xs uppercase text-gray-600",children:"Resultado"}),e.jsx("p",{className:"text-xl font-bold text-blue-700",children:v(be-_e)})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"DRE (competência) • Entradas x Despesas"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>J(Q.current,"dre-competencia"),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg text-gray-700 hover:bg-gray-50",children:"PNG"}),e.jsx("button",{type:"button",onClick:()=>ke(Q.current,"DRE (competência)"),className:"px-3 py-2 text-sm border border-gray-200 rounded-lg text-gray-700 hover:bg-gray-50",children:"PDF"})]})]}),e.jsx("div",{className:"h-80",ref:Q,children:ze.length>0?e.jsx(tt,{width:"100%",height:"100%",children:e.jsxs(rt,{data:ze,children:[e.jsx($e,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),e.jsx(Se,{dataKey:"date",tick:{fill:"#94a3b8",fontSize:12},tickFormatter:Ie}),e.jsx(Ee,{tick:{fill:"#94a3b8",fontSize:12},tickFormatter:a=>`R$${(a/1e3).toFixed(1)}k`}),e.jsx(Fe,{formatter:a=>v(a),labelFormatter:a=>`Mês: ${Ie(a)}`}),e.jsx(Pe,{dataKey:"receitas",name:"Entradas",fill:"#22c55e",radius:[6,6,0,0]}),e.jsx(Pe,{dataKey:"despesas",name:"Despesas",fill:"#ef4444",radius:[6,6,0,0]}),e.jsx(Pe,{dataKey:"resultado",name:"Resultado",fill:"#3b82f6",radius:[6,6,0,0]})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-gray-400 text-sm",children:"Sem dados para o período selecionado."})})]})]}),U==="caixa"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-100",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Faturamento emitido (mês)"}),e.jsx("p",{className:"text-xl font-bold text-gray-800",children:v(be)})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-100",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Recebimento previsto caixa  (filtro)"}),e.jsx("p",{className:"text-xl font-bold text-green-600",children:v(xt)})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-100",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Pagamento previsto caixa (mês)"}),e.jsx("p",{className:"text-xl font-bold text-red-600",children:v(gt)})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Fluxo de Caixa (Saldo Previsto)+ Saldo Banco "}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>X("linha"),className:`px-3 py-2 text-sm border rounded-lg ${Y==="linha"?"bg-brand-600 text-white border-brand-600":"bg-white text-gray-700 border-gray-200"}`,children:"Linha"}),e.jsx("button",{type:"button",onClick:()=>X("coluna"),className:`px-3 py-2 text-sm border rounded-lg ${Y==="coluna"?"bg-brand-600 text-white border-brand-600":"bg-white text-gray-700 border-gray-200"}`,children:"Coluna"})]})]}),e.jsx("div",{className:"h-72",children:me.length>0?e.jsx(tt,{width:"100%",height:"100%",children:Y==="linha"?e.jsxs(Zt,{data:We,children:[e.jsx($e,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),e.jsx(Se,{dataKey:"data",tick:{fill:"#94a3b8",fontSize:12},tickFormatter:Me}),e.jsx(Ee,{tick:{fill:"#94a3b8",fontSize:12},tickFormatter:a=>`R$${(a/1e3).toFixed(1)}k`}),e.jsx(Fe,{content:e.jsx(Qe,{})}),e.jsx(at,{y:0,stroke:"#ef4444",strokeDasharray:"4 4"}),e.jsx(ye,{type:"linear",dataKey:"saldo",stroke:"#0ea5e9",strokeWidth:2,dot:!1})]}):e.jsxs(rt,{data:We,children:[e.jsx($e,{strokeDasharray:"3 3",vertical:!1,stroke:"#f1f5f9"}),e.jsx(Se,{dataKey:"data",tick:{fill:"#94a3b8",fontSize:12},tickFormatter:Me}),e.jsx(Ee,{tick:{fill:"#94a3b8",fontSize:12},tickFormatter:a=>`R$${(a/1e3).toFixed(1)}k`}),e.jsx(Fe,{content:e.jsx(Qe,{})}),e.jsx(at,{y:0,stroke:"#ef4444",strokeDasharray:"4 4"}),e.jsx(Pe,{dataKey:"saldo",name:"Saldo",fill:"#0ea5e9",radius:[6,6,0,0]})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-gray-400 text-sm",children:"Nenhuma previsão no período."})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Fluxo Previsto (mensal)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:ht,className:"px-3 py-2 text-sm border border-gray-200 rounded-lg text-gray-700 hover:bg-gray-50",children:"Excel"}),e.jsx("button",{type:"button",onClick:ft,className:"px-3 py-2 text-sm border border-gray-200 rounded-lg text-gray-700 hover:bg-gray-50",children:"PDF"})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-500 border-b border-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"Competência"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Receitas"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Despesas"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Saldo"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Saldo Acumulado"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Saldo Banco"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100",children:[Ne.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-2 text-gray-700",children:Ie(`${a.ano}-${String(a.mes).padStart(2,"0")}`)}),e.jsx("td",{className:"px-4 py-2 text-right text-green-600 font-medium",children:v(a.totalReceitasPrevistas)}),e.jsx("td",{className:"px-4 py-2 text-right text-red-600 font-medium",children:v(a.totalDespesasPrevistas)}),e.jsx("td",{className:"px-4 py-2 text-right font-semibold",children:v(a.saldoPrevistoMes)}),e.jsx("td",{className:"px-4 py-2 text-right font-semibold",children:v(a.saldoAcumulado)}),e.jsx("td",{className:"px-4 py-2 text-right font-semibold",children:v(a.saldoBanco||0)})]},`${a.ano}-${a.mes}`)),Ne.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-4 text-gray-400",children:"Sem previsões mensais."})})]})]})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3 mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Fluxo Previsto (período)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:Oe,className:"px-3 py-2 text-sm border border-gray-200 rounded-lg text-gray-700 hover:bg-gray-50",children:"Excel"}),e.jsx("button",{type:"button",onClick:Ce,className:"px-3 py-2 text-sm border border-gray-200 rounded-lg text-gray-700 hover:bg-gray-50",children:"PDF"})]})]}),e.jsx("div",{className:"overflow-x-auto max-h-96 overflow-y-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-500 border-b border-gray-100 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"Data"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Receitas"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Despesas"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Saldo do Dia"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Saldo Acumulado"}),e.jsx("th",{className:"px-4 py-2 text-right",children:"Saldo Banco"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100",children:[ve.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-2 text-gray-700",children:a.data.toLocaleDateString("pt-BR")}),e.jsx("td",{className:"px-4 py-2 text-right text-green-600 font-medium",children:v(a.totalReceitasPrevistas)}),e.jsx("td",{className:"px-4 py-2 text-right text-red-600 font-medium",children:v(a.totalDespesasPrevistas)}),e.jsx("td",{className:"px-4 py-2 text-right font-semibold",children:v(a.saldoPrevistoDia)}),e.jsx("td",{className:"px-4 py-2 text-right font-semibold",children:v(a.saldoAcumulado)}),e.jsx("td",{className:"px-4 py-2 text-right font-semibold",children:v(a.saldoBanco||0)})]},a.data.toString())),ve.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-4 text-gray-400",children:"Sem previsões registradas."})})]})]})})]})]})]})};export{ua as default};
