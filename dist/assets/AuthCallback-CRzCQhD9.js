import{b as k,r as g,j as n,s as f}from"./index-Bi_Yktdj.js";const x=r=>{const e=r.toLowerCase();return e.includes("code verifier")||e.includes("code_verifier")?"Link aberto em outro navegador/dispositivo. Solicite um novo link.":e.includes("invalid")||e.includes("expired")||e.includes("access_denied")?"Link inválido ou expirado. Solicite um novo link.":r},b=(r,e)=>{},y=()=>{const r=k(),[e,i]=g.useState("loading"),[p,c]=g.useState("Validando login...");return g.useEffect(()=>{(async()=>{try{const s=new URL(window.location.href),d=s.hash.startsWith("#")?s.hash.slice(1):s.hash,v=d.includes("?")?d.split("?")[1]:d,o=new URLSearchParams(v),a=s.searchParams.get("redirectTo")||o.get("redirectTo"),l=s.searchParams.get("code")||o.get("code"),u=s.searchParams.get("error_description")||s.searchParams.get("error")||o.get("error_description")||o.get("error"),h=o.get("access_token"),m=o.get("refresh_token");if(b("params",{hasCode:!!l,hasAccessToken:!!h,hasRefreshToken:!!m,hasRedirectTo:!!a,errorParam:u}),u){i("error"),c(x(u));return}if(l){const{error:t}=await f.auth.exchangeCodeForSession(l);if(t)throw t}else if(h&&m){const{error:t}=await f.auth.setSession({access_token:h,refresh_token:m});if(t)throw t}else{const{data:t}=await f.auth.getSession();if(!t.session){i("error"),c("Sessão de autenticação não encontrada. Solicite um novo link.");return}}const w=a&&a.startsWith("/")&&!a.startsWith("//")?a:"/";i("success"),c("Autenticado! Redirecionando..."),r(w,{replace:!0})}catch(s){i("error"),c(x(s?.message||"Erro ao validar login."))}})()},[r]),n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 px-4",children:n.jsxs("div",{className:"bg-white shadow-md rounded-lg p-6 w-full max-w-md text-center space-y-2",children:[n.jsxs("div",{className:"text-lg font-semibold",children:[e==="loading"&&"Conectando...",e==="success"&&"Sucesso!",e==="error"&&"Algo deu errado"]}),n.jsx("p",{className:"text-sm text-gray-600",children:p}),e==="error"&&n.jsx("button",{onClick:()=>r("/login"),className:"mt-3 inline-flex items-center justify-center px-4 py-2 text-sm font-medium text-white bg-brand-600 rounded-md hover:bg-brand-700",children:"Voltar para login"})]})})};export{y as default};
